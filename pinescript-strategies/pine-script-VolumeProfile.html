<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../styles/blog-common.css" />
    <style>
        .fullscreen {
            padding: 10px 50px;
            max-width: 70%;
            margin: auto;
            text-align: justify;
        }
        .tip {
            background: #e8f4fc;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
        }
        .code-comment {
            color: #6a9955;
            font-style: italic;
        }
    </style>
    <script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/1d0bc1a6c5f92dbb39d740b56/298aebd458318fd32c6cfc6a7.js");</script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0MM8039GLD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-0MM8039GLD');
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9243803325136617" crossorigin="anonymous"></script>

    <title>Pine Script Volume Profile - Complete TradingView Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Master Volume Profile in Pine Script for TradingView - a powerful tool to analyze volume distribution across price levels, identify key support/resistance zones, and understand market conviction.">
    <meta name="keywords" content="pine script strategies, Volume Profile, POC, Value Area, HVN, LVN, tradingview indicator, technical analysis, volume distribution, market profile, support resistance, supply demand">

    <!-- Open Graph / Social Meta -->
    <meta property="og:title" content="Pine Script Volume Profile - Complete TradingView Guide">
    <meta property="og:description" content="Comprehensive tutorial on implementing and using Volume Profile in Pine Script for advanced trading strategies.">
    <meta property="og:type" content="article">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Pine Script Volume Profile - Complete TradingView Guide">
    <link rel="canonical" href="https://offline-pixel.github.io/pinescript-strategies/pine-script-VolumeProfile.html" />

    <!-- JSON-LD Schema -->
    <link rel="icon" href="../favicon.ico" type="image/x-icon">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "Pine Script Volume Profile - Complete TradingView Guide",
      "description": "Master Volume Profile in Pine Script for TradingView - a powerful tool to analyze volume distribution across price levels, identify key support/resistance zones, and understand market conviction.",
      "author": {
        "@type": "Person",
        "name": "Offline Pixel Computers"
      },
      "datePublished": "2025-06-16",
      "image": "https://offline-pixel.github.io/assets/logo2.png",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://offline-pixel.github.io/pinescript-strategies/pine-script-VolumeProfile.html"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Offline Pixel",
        "logo": {
          "@type": "ImageObject",
          "url": "https://offline-pixel.github.io/assets/logo2.png"
        }
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://offline-pixel.github.io/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "PineScript Strategies",
            "item": "https://offline-pixel.github.io/pinescript-strategies.html"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Volume Profile",
            "item": "https://offline-pixel.github.io/pinescript-strategies/pine-script-VolumeProfile.html"
          }
        ]
      }
    }
    </script>
</head>
<body>
  <header class="blog-header">
    <div class="container">
      <h1 class="blog-title">Pine Script Volume Profile </h1>
      <p class="blog-subtitle">Master this powerful technical analysis tool in TradingView's Pine Script that displays trading activity over a specified price range, revealing key areas of supply and demand for more informed trading decisions.</p>
      <p class="job-meta">
        <span class="job-posted-time">Last Updated on: <span id="dynamicDatePosted"></span></span>
        <span class="job-location">Expertise: Advanced</span>
      </p>
    </div>
  </header>

  <article class="fullscreen">
<nav class="breadcrumb" aria-label="Breadcrumb">
  <a href="https://offline-pixel.github.io/">Home</a> >
  <a href="https://offline-pixel.github.io/pinescript-strategies.html">PineScript Strategies</a> >
  <span aria-current="page">Volume Profile</span>
</nav>

  <div class="pinescript-disclaimer"></div>
  <ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9243803325136617"
     data-ad-slot="5548365171"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    <h2>What is Volume Profile?</h2>
    <p> <b>Volume Profile</b> is an advanced charting indicator that displays trading activity over a specified price range during a specified period. It shows the total volume traded at each price level, often represented as a horizontal histogram on the left or right side of the price chart. Unlike traditional volume indicators that show total volume traded over a specific time period (e.g., a bar), Volume Profile reveals *where* that volume was traded across different price points.</p>

    <p>This insight into the distribution of volume provides a deeper understanding of market dynamics and participant behavior. Key components derived from the Volume Profile include:</p>
    <ul>
      <li> <b>Point of Control (POC):</b> The price level with the highest traded volume for the specified period. It represents the price where the most trading activity occurred and is considered a fair value area.</li>
      <li> <b>Value Area (VA):</b> The price range where a significant percentage of the total volume (typically 70% or 68%) was traded. It signifies where the majority of participants found value.</li>
      <li> <b>High Volume Nodes (HVN):</b> Price levels where a large amount of volume was traded, indicating areas of agreement or consolidation. These often act as strong support or resistance.</li>
      <li> <b>Low Volume Nodes (LVN):</b> Price levels where very little volume was traded, indicating areas of disagreement or rapid price movement. These often act as weak support/resistance and tend to be easily broken through.</li>
    </ul>

    <p>Volume Profile is an indispensable tool for active traders, helping them identify key supply/demand zones, understand market sentiment, and plan their <b>pine script strategies</b> for entries, exits, and risk management.</p>

    <h2>Components and Calculation (Conceptual)</h2>
    <p>The Volume Profile is constructed by taking all the trades (volume) that occurred within a defined time window (e.g., a day, a week, or a fixed number of bars) and categorizing them into discrete price "bins" or levels. For each bin, the total volume traded at that price level is accumulated. This accumulation is then displayed as a horizontal bar, with longer bars indicating more volume traded at that price.
    
    The calculation conceptually involves:</p>
    <ol>
      <li> <b>Define the Analysis Period:</b> This can be a specific session (e.g., daily, weekly) or a fixed number of bars (e.g., last 100 bars).</li>
      <li> <b>Determine Price Range:</b> Identify the high and low prices within the analysis period.</li>
      <li> <b>Define Bins:</b> Divide the price range into a specified number of equal price "bins." For example, if the range is $10 and you want 10 bins, each bin would be $1 wide.</li>
      <li> <b>Distribute Volume:</b> For each bar within the analysis period, distribute its volume across the price bins that its `high`-`low` range covers. If a bar's `high` is in one bin and its `low` in another, its volume is proportionally distributed. Many implementations simply assign the bar's entire volume to the bin corresponding to its `close` price, or use a more complex mid-point distribution.</li>
      <li> <b>Aggregate Volume per Bin:</b> Sum up the volume for each price bin.</li>
      <li> <b>Identify POC, VA, HVN, LVN:</b> Once the volume distribution is complete, the POC is the bin with the highest volume. The Value Area is found by accumulating volume from the POC outwards until the specified percentage (e.g., 70%) of total volume is reached. HVNs are visually prominent large bars, and LVNs are visually prominent small bars or gaps.</li>
    </ol>

    <h2>Basic Volume Profile Implementation in Pine Script</h2>
    <p>Pine Script v5 significantly simplifies Volume Profile implementation with its dedicated `volume` module. It provides functions like `volume.profile_fixed()` and `volume.profile_session()` to draw these profiles directly on the chart.</p>
<pre><code>
<span class="comment">//@version=5</span>
<span class="keyword">indicator</span>(<span class="string">"My Volume Profile"</span>, <span class="property">overlay</span>=<span class="literal">true</span>, <span class="property">max_bars_back</span>=<span class="number">500</span>) <span class="comment">// overlay=true to plot on price chart.</span>

<span class="comment">// --- User Inputs ---</span>
<span class="variable">profileType</span> = <span class="function">input.string</span>(<span class="string">"Fixed Range"</span>, <span class="property">title</span>=<span class="string">"Profile Type"</span>, <span class="property">options</span>=[<span class="string">"Fixed Range"</span>, <span class="string">"Session Profile"</span>])
<span class="variable">fixedRangeBars</span> = <span class="function">input.int</span>(<span class="number">100</span>, <span class="property">title</span>=<span class="string">"Fixed Range Bars (for Fixed Range Profile)"</span>, <span class="property">minval</span>=<span class="number">10</span>, <span class="property">maxval</span>=<span class="number">500</span>, <span class="property">tooltip</span>=<span class="string">"Number of historical bars to calculate the fixed volume profile over."</span>)
<span class="variable">numberOfRows</span> = <span class="function">input.int</span>(<span class="number">20</span>, <span class="property">title</span>=<span class="string">"Number of Rows (Bins)"</span>, <span class="property">minval</span>=<span class="number">5</span>, <span class="property">maxval</span>=<span class="number">100</span>, <span class="property">tooltip</span>=<span class="string">"Number of price bins for the volume profile histogram."</span>)
<span class="variable">valueAreaPercentage</span> = <span class="function">input.int</span>(<span class="number">70</span>, <span class="property">title</span>=<span class="string">"Value Area (%)"</span>, <span class="property">minval</span>=<span class="number">50</span>, <span class="property">maxval</span>=<span class="number">99</span>, <span class="property">tooltip</span>=<span class="string">"Percentage of total volume contained within the Value Area."</span>)

<span class="comment">// --- Plotting Colors ---</span>
<span class="variable">upVolumeColor</span> = <span class="function">input.color</span>(<span class="function">color.new</span>(<span class="constant">color.lime</span>, <span class="number">40</span>), <span class="property">title</span>=<span class="string">"Up Volume Color"</span>)
<span class="variable">downVolumeColor</span> = <span class="function">input.color</span>(<span class="function">color.new</span>(<span class="constant">color.red</span>, <span class="number">40</span>), <span class="property">title</span>=<span class="string">"Down Volume Color"</span>)
<span class="variable">pocColor</span> = <span class="function">input.color</span>(<span class="function">color.new</span>(<span class="constant">color.purple</span>, <span class="number">0</span>), <span class="property">title</span>=<span class="string">"POC Color"</span>)
<span class="variable">vaColor</span> = <span class="function">input.color</span>(<span class="function">color.new</span>(<span class="constant">color.yellow</span>, <span class="number">60</span>), <span class="property">title</span>=<span class="string">"Value Area Color"</span>)

<span class="comment">// --- Implement Volume Profile Logic ---</span>

<span class="keyword">if</span> <span class="variable">profileType</span> == <span class="string">"Fixed Range"</span>
    <span class="comment">// Use volume.profile_fixed for a profile calculated over a fixed number of recent bars.</span>
    <span class="variable">profile</span> = <span class="function">volume.profile_fixed</span>(<span class="variable">fixedRangeBars</span>, <span class="variable">numberOfRows</span>, <span class="variable">valueAreaPercentage</span>)

    <span class="keyword">if</span> <span class="variable">barstate.islast</span> <span class="keyword">and</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>)
        <span class="variable">profile</span>.<span class="function">plot</span>(<span class="variable">upVolumeColor</span>, <span class="variable">downVolumeColor</span>, <span class="variable">pocColor</span>, <span class="variable">vaColor</span>)

<span class="keyword">else if</span> <span class="variable">profileType</span> == <span class="string">"Session Profile"</span>
    <span class="variable">profile</span> = <span class="function">volume.profile_session</span>(<span class="variable">numberOfRows</span>, <span class="variable">valueAreaPercentage</span>)

    <span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>)
        <span class="variable">profile</span>.<span class="function">plot</span>(<span class="variable">upVolumeColor</span>, <span class="variable">downVolumeColor</span>, <span class="variable">pocColor</span>, <span class="variable">vaColor</span>)

<span class="comment">// Note: Pine Script's built-in `volume` module handles the complex drawing</span>
<span class="comment">// of the histogram, POC line, and Value Area shading automatically.</span>
<span class="comment">// We just need to define the parameters and tell it to plot.</span>
</code></pre>


    <div class="tip">
      <strong>Supply & Demand Hotspots:</strong> Volume Profile helps identify where the majority of trading activity occurred, pinpointing true supply and demand zones where institutions and large players have likely taken positions.
    </div>

    <h2>Practical Volume Profile <a href="https://offline-pixel.github.io/pinescript-strategies.html">Trading Strategies</a></h2>

    <h3>1. Support and Resistance with HVNs & LVNs</h3>
    <p>HVNs act as strong areas of agreement and potential support/resistance, while LVNs represent areas of rapid transit and weak support/resistance.</p>
    <ul>
      <li> <b>HVN as Support/Resistance:</b> When price approaches an HVN, it's likely to consolidate or reverse as significant past trading activity suggests strong conviction at that level. Long entries near an HVN acting as support; short entries near an HVN acting as resistance.</li>
      <li> <b>LVN as Price Magnet/Breakout:</b> Price tends to move quickly through LVNs because there was little prior agreement. An LVN can act as a "price magnet" when price approaches it, or a zone where breakouts are likely to accelerate.</li>
    </ul>
<pre><code>
<span class="comment">//@version=5</span>
<span class="keyword">strategy</span>(<span class="string">"VP: HVN/LVN Strategy"</span>, <span class="property">overlay</span>=<span class="literal">true</span>)

<span class="comment">// Use a session profile for clear daily levels</span>
<span class="variable">numberOfRows</span> = <span class="function">input.int</span>(<span class="number">30</span>, <span class="property">title</span>=<span class="string">"Number of Rows (Bins)"</span>, <span class="property">minval</span>=<span class="number">5</span>, <span class="property">maxval</span>=<span class="number">100</span>)
<span class="variable">valueAreaPercentage</span> = <span class="function">input.int</span>(<span class="number">70</span>, <span class="property">title</span>=<span class="string">"Value Area (%)"</span>, <span class="property">minval</span>=<span class="number">50</span>, <span class="property">maxval</span>=<span class="number">99</span>)

<span class="variable">profile</span> = <span class="function">volume.profile_session</span>(<span class="variable">numberOfRows</span>, <span class="variable">valueAreaPercentage</span>)

<span class="comment">// Plotting (kept for visual context, usually this is in a separate indicator script)</span>
<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>)
    <span class="variable">profile</span>.<span class="function">plot</span>(
        <span class="function">color.new</span>(<span class="constant">color.lime</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.red</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.purple</span>, <span class="number">0</span>),
        <span class="function">color.new</span>(<span class="constant">color.yellow</span>, <span class="number">60</span>)
    )

<span class="comment">// Example strategy logic (conceptual, as Pine Script strategy cannot directly access historical HVN/LVN)</span>
<span class="comment">// The `volume.profile_session` only returns the current session's profile.</span>
<span class="comment">// To get previous session's POC/VA, use request.security + profile_fixed</span>

<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>) <span class="keyword">and</span> <span class="variable">barstate.isconfirmed</span>
    <span class="variable">pocPrice</span> = <span class="variable">profile</span>.<span class="property">poc_price</span>

    <span class="comment">// Simple strategy: Price crosses POC</span>
    <span class="variable">longCondition</span> = <span class="function">ta.crossover</span>(<span class="variable">close</span>, <span class="variable">pocPrice</span>)
    <span class="variable">shortCondition</span> = <span class="function">ta.crossunder</span>(<span class="variable">close</span>, <span class="variable">pocPrice</span>)

    <span class="keyword">if</span> <span class="variable">longCondition</span>
        <span class="function">strategy.entry</span>(<span class="string">"Long POC Break"</span>, <span class="constant">strategy.long</span>)

    <span class="keyword">if</span> <span class="variable">shortCondition</span>
        <span class="function">strategy.entry</span>(<span class="string">"Short POC Break"</span>, <span class="constant">strategy.short</span>)

    <span class="comment">// Exit on opposite POC cross</span>
    <span class="function">strategy.close</span>(<span class="string">"Long POC Break"</span>, <span class="property">when</span>=<span class="variable">shortCondition</span>)
    <span class="function">strategy.close</span>(<span class="string">"Short POC Break"</span>, <span class="property">when</span>=<span class="variable">longCondition</span>)
</code></pre>

    <h3>2. Value Area (VA) as Fair Price Zone</h3>
    <p>The Value Area represents where the majority of trades occurred and where market participants found "fair value."</p>
    <ul>
      <li> <b>Trading within Value Area:</b> Price tends to spend a significant amount of time within the Value Area. If price opens within the VA, it suggests a rotational or range-bound day.</li>
      <li> <b>Opening outside Value Area:</b> If price opens significantly outside the previous day's Value Area (and especially outside the Value Area High/Low), it often suggests a trending day, as the market is seeking a new fair value.
        <ul>
          <li> <b>Open above VAH (Value Area High):</b> Strong bullish bias, target higher prices.</li>
          <li> <b>Open below VAL (Value Area Low):</b> Strong bearish bias, target lower prices.</li>
        </ul>
      </li>
      <li> <b>VA as Support/Resistance:</b> The Value Area High (VAH) and Value Area Low (VAL) act as dynamic support and resistance levels.</li>
    </ul>
<pre><code>
<span class="comment">//@version=5</span>
<span class="keyword">strategy</span>(<span class="string">"VP: Value Area Strategy"</span>, <span class="property">overlay</span>=<span class="literal">true</span>)

<span class="variable">numberOfRows</span> = <span class="function">input.int</span>(<span class="number">30</span>, <span class="property">title</span>=<span class="string">"Number of Rows (Bins)"</span>, <span class="property">minval</span>=<span class="number">5</span>, <span class="property">maxval</span>=<span class="number">100</span>)
<span class="variable">valueAreaPercentage</span> = <span class="function">input.int</span>(<span class="number">70</span>, <span class="property">title</span>=<span class="string">"Value Area (%)"</span>, <span class="property">minval</span>=<span class="number">50</span>, <span class="property">maxval</span>=<span class="number">99</span>)

<span class="variable">profile</span> = <span class="function">volume.profile_session</span>(<span class="variable">numberOfRows</span>, <span class="variable">valueAreaPercentage</span>)

<span class="comment">// Plotting</span>
<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>)
    <span class="variable">profile</span>.<span class="function">plot</span>(
        <span class="function">color.new</span>(<span class="constant">color.lime</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.red</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.purple</span>, <span class="number">0</span>),
        <span class="function">color.new</span>(<span class="constant">color.yellow</span>, <span class="number">60</span>)
    )

<span class="comment">// Store previous session VAH/VAL manually</span>
<span class="keyword">var</span> <span class="type">float</span> <span class="variable">prevVAH</span> = <span class="literal">na</span>
<span class="keyword">var</span> <span class="type">float</span> <span class="variable">prevVAL</span> = <span class="literal">na</span>

<span class="variable">isNewSession</span> = <span class="function">ta.change</span>(<span class="function">time</span>(<span class="string">"D"</span>))

<span class="keyword">if</span> <span class="variable">isNewSession</span>[<span class="number">1</span>] <span class="keyword">and</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>[<span class="number">1</span>])
    <span class="variable">prevVAH</span> := <span class="variable">profile</span>[<span class="number">1</span>].<span class="property">value_area_high</span>
    <span class="variable">prevVAL</span> := <span class="variable">profile</span>[<span class="number">1</span>].<span class="property">value_area_low</span>

<span class="variable">prevVAH</span> := <span class="function">nz</span>(<span class="variable">prevVAH</span>[<span class="number">1</span>], <span class="variable">prevVAH</span>)
<span class="variable">prevVAL</span> := <span class="function">nz</span>(<span class="variable">prevVAL</span>[<span class="number">1</span>], <span class="variable">prevVAL</span>)

<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">prevVAH</span>) <span class="keyword">and</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">prevVAL</span>)

    <span class="comment">// Absorption entries</span>
    <span class="variable">longAbsorption</span> = <span class="variable">open</span> &lt; <span class="variable">prevVAL</span> <span class="keyword">and</span> <span class="variable">close</span> > <span class="variable">prevVAL</span>
    <span class="variable">shortAbsorption</span> = <span class="variable">open</span> > <span class="variable">prevVAH</span> <span class="keyword">and</span> <span class="variable">close</span> &lt; <span class="variable">prevVAH</span>

    <span class="keyword">if</span> (<span class="variable">longAbsorption</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Long VA Absorb"</span>, <span class="constant">strategy.long</span>)
        <span class="function">strategy.exit</span>(<span class="string">"Long VA Absorb Exit"</span>, <span class="property">profit</span>=<span class="variable">prevVAH</span>, <span class="property">stop</span>=<span class="variable">prevVAL</span> - <span class="variable">syminfo.mintick</span> * <span class="number">10</span>)

    <span class="keyword">if</span> (<span class="variable">shortAbsorption</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Short VA Absorb"</span>, <span class="constant">strategy.short</span>)
        <span class="function">strategy.exit</span>(<span class="string">"Short VA Absorb Exit"</span>, <span class="property">profit</span>=<span class="variable">prevVAL</span>, <span class="property">stop</span>=<span class="variable">prevVAH</span> + <span class="variable">syminfo.mintick</span> * <span class="number">10</span>)

    <span class="comment">// Trend continuation entries</span>
    <span class="variable">longTrendDay</span> = <span class="variable">open</span> > <span class="variable">prevVAH</span> <span class="keyword">and</span> <span class="variable">close</span> > <span class="variable">open</span> <span class="keyword">and</span> <span class="variable">close</span> > <span class="variable">prevVAH</span>
    <span class="variable">shortTrendDay</span> = <span class="variable">open</span> &lt; <span class="variable">prevVAL</span> <span class="keyword">and</span> <span class="variable">close</span> &lt; <span class="variable">open</span> <span class="keyword">and</span> <span class="variable">close</span> &lt; <span class="variable">prevVAL</span>

    <span class="keyword">if</span> (<span class="variable">longTrendDay</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Long VA Trend"</span>, <span class="constant">strategy.long</span>)
        <span class="function">strategy.exit</span>(<span class="string">"Long VA Trend Exit"</span>, <span class="property">profit</span>=<span class="variable">strategy.position_avg_price</span> + (<span class="variable">prevVAH</span> - <span class="variable">prevVAL</span>) * <span class="number">1.5</span>, <span class="property">stop</span>=<span class="variable">prevVAH</span>)

    <span class="keyword">if</span> (<span class="variable">shortTrendDay</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Short VA Trend"</span>, <span class="constant">strategy.short</span>)
        <span class="function">strategy.exit</span>(<span class="string">"Short VA Trend Exit"</span>, <span class="property">profit</span>=<span class="variable">strategy.position_avg_price</span> - (<span class="variable">prevVAH</span> - <span class="variable">prevVAL</span>) * <span class="number">1.5</span>, <span class="property">stop</span>=<span class="variable">prevVAL</span>)
</code></pre>


    <h3>3. POC Rejection/Breakout</h3>
    <p>The Point of Control (POC) is the single most traded price level. It acts as a significant magnet and a strong area of support/resistance.</p>
    <ul>
      <li> <b>POC Rejection:</b> Price rallies towards the POC and then reverses, suggesting strong supply at POC. Or declines to POC and reverses, suggesting strong demand. Often seen on less volatile days.</li>
      <li> <b>POC Breakout:</b> Price decisively breaks and holds above/below the POC, often indicating a shift in fair value and potential trend continuation. A breakout of POC, especially with increased volume, is a strong signal that market participants are accepting higher/lower prices.</li>
    </ul>
<pre><code>
<span class="comment">//@version=5</span>
<span class="keyword">strategy</span>(<span class="string">"VP: POC Strategy"</span>, <span class="property">overlay</span>=<span class="literal">true</span>)

<span class="variable">numberOfRows</span> = <span class="function">input.int</span>(<span class="number">30</span>, <span class="property">title</span>=<span class="string">"Number of Rows (Bins)"</span>, <span class="property">minval</span>=<span class="number">5</span>, <span class="property">maxval</span>=<span class="number">100</span>)
<span class="variable">valueAreaPercentage</span> = <span class="function">input.int</span>(<span class="number">70</span>, <span class="property">title</span>=<span class="string">"Value Area (%)"</span>, <span class="property">minval</span>=<span class="number">50</span>, <span class="property">maxval</span>=<span class="number">99</span>)

<span class="variable">profile</span> = <span class="function">volume.profile_session</span>(<span class="variable">numberOfRows</span>, <span class="variable">valueAreaPercentage</span>)

<span class="comment">// Plotting</span>
<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>)
    <span class="variable">profile</span>.<span class="function">plot</span>(
        <span class="function">color.new</span>(<span class="constant">color.lime</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.red</span>, <span class="number">40</span>),
        <span class="function">color.new</span>(<span class="constant">color.purple</span>, <span class="number">0</span>),
        <span class="function">color.new</span>(<span class="constant">color.yellow</span>, <span class="number">60</span>)
    )

<span class="comment">// Get POC from previous session</span>
<span class="keyword">var</span> <span class="type">float</span> <span class="variable">prevPOC</span> = <span class="literal">na</span>

<span class="variable">isNewSession</span> = <span class="function">ta.change</span>(<span class="function">time</span>(<span class="string">"D"</span>))

<span class="keyword">if</span> <span class="variable">isNewSession</span>[<span class="number">1</span>] <span class="keyword">and</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">profile</span>[<span class="number">1</span>])
    <span class="variable">prevPOC</span> := <span class="variable">profile</span>[<span class="number">1</span>].<span class="property">poc_price</span>

<span class="variable">prevPOC</span> := <span class="function">nz</span>(<span class="variable">prevPOC</span>[<span class="number">1</span>], <span class="variable">prevPOC</span>)

<span class="comment">// Strategy Logic</span>
<span class="keyword">if</span> <span class="keyword">not</span> <span class="function">na</span>(<span class="variable">prevPOC</span>)

    <span class="comment">// Rejection logic</span>
    <span class="variable">longPOCRejection</span> = <span class="variable">low</span> &lt; <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span> > <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span>[<span class="number">1</span>] &lt; <span class="variable">prevPOC</span>[<span class="number">1</span>]
    <span class="variable">shortPOCRejection</span> = <span class="variable">high</span> > <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span> &lt; <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span>[<span class="number">1</span>] > <span class="variable">prevPOC</span>[<span class="number">1</span>]

    <span class="keyword">if</span> (<span class="variable">longPOCRejection</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Long POC Rejection"</span>, <span class="constant">strategy.long</span>)
        <span class="function">strategy.exit</span>(
            <span class="string">"Long POC Rejection Exit"</span>,
            <span class="property">profit</span>=<span class="variable">prevPOC</span> + (<span class="variable">prevPOC</span> - <span class="variable">open</span>) * <span class="number">1.0</span>,
            <span class="property">stop</span>=<span class="variable">prevPOC</span> - (<span class="variable">prevPOC</span> - <span class="variable">low</span>) * <span class="number">1.0</span>
        )

    <span class="keyword">if</span> (<span class="variable">shortPOCRejection</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Short POC Rejection"</span>, <span class="constant">strategy.short</span>)
        <span class="function">strategy.exit</span>(
            <span class="string">"Short POC Rejection Exit"</span>,
            <span class="property">profit</span>=<span class="variable">prevPOC</span> - (<span class="variable">open</span> - <span class="variable">prevPOC</span>) * <span class="number">1.0</span>,
            <span class="property">stop</span>=<span class="variable">prevPOC</span> + (<span class="variable">high</span> - <span class="variable">prevPOC</span>) * <span class="number">1.0</span>
        )

    <span class="comment">// Breakout logic</span>
    <span class="variable">longPOCBreakout</span> = <span class="variable">close</span> > <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span>[<span class="number">1</span>] &lt;= <span class="variable">prevPOC</span>[<span class="number">1</span>] <span class="keyword">and</span> <span class="variable">volume</span> > <span class="function">ta.sma</span>(<span class="variable">volume</span>, <span class="number">20</span>) * <span class="number">1.2</span>
    <span class="variable">shortPOCBreakout</span> = <span class="variable">close</span> &lt; <span class="variable">prevPOC</span> <span class="keyword">and</span> <span class="variable">close</span>[<span class="number">1</span>] >= <span class="variable">prevPOC</span>[<span class="number">1</span>] <span class="keyword">and</span> <span class="variable">volume</span> > <span class="function">ta.sma</span>(<span class="variable">volume</span>, <span class="number">20</span>) * <span class="number">1.2</span>

    <span class="keyword">if</span> (<span class="variable">longPOCBreakout</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Long POC Breakout"</span>, <span class="constant">strategy.long</span>)
        <span class="function">strategy.exit</span>(
            <span class="string">"Long POC Breakout Exit"</span>,
            <span class="property">profit</span>=<span class="variable">strategy.position_avg_price</span> + (<span class="variable">high</span> - <span class="variable">prevPOC</span>) * <span class="number">1.5</span>,
            <span class="property">stop</span>=<span class="variable">prevPOC</span>
        )

    <span class="keyword">if</span> (<span class="variable">shortPOCBreakout</span>)
        <span class="function">strategy.entry</span>(<span class="string">"Short POC Breakout"</span>, <span class="constant">strategy.short</span>)
        <span class="function">strategy.exit</span>(
            <span class="string">"Short POC Breakout Exit"</span>,
            <span class="property">profit</span>=<span class="variable">strategy.position_avg_price</span> - (<span class="variable">prevPOC</span> - <span class="variable">low</span>) * <span class="number">1.5</span>,
            <span class="property">stop</span>=<span class="variable">prevPOC</span>
        )
</code></pre>


    <h2>Optimizing Volume Profile Performance</h2>
    <p>To get the most from Volume Profile in Pine Script:</p>
    <ul>
      <li> <b>Contextual Analysis:</b> Volume Profile is best used in conjunction with price action and overall market context. Understand the broader trend before trading individual VP levels.</li>
      <li> <b>Timeframe Selection:</b> The chosen `profileType` ("Fixed Range" vs. "Session Profile") and the chart's timeframe greatly impact the profile's relevance. Daily session profiles are excellent for intraday decisions, while fixed profiles over longer periods can highlight significant longer-term supply/demand zones.</li>
      <li> <b>Number of Rows (Bins):</b> Experiment with the `numberOfRows`. Too few bins can make the profile too coarse, missing subtle nuances. Too many can make it overly detailed and noisy. Start with 20-30 and adjust.</li>
      <li> <b>Value Area Percentage:</b> The default 70% is common, but some traders prefer 68% or other percentages depending on their focus (e.g., tighter VA for strong agreement).</li>
      <li> <b>Confluence with Other Indicators:</b> Volume Profile levels (POC, VAH/VAL, HVN/LVN) gain significant strength when they align with other technical indicators like:
        <ul>
          <li>Moving Averages</li>
          <li>Fibonacci Retracements/Extensions</li>
          <li>Trendlines</li>
          <li>Psychological price levels</li>
        </ul>
      </li>
      <li> <b>Volume Confirmation:</b> Always seek confirmation from volume. A breakout of a key level with strong, increasing volume is more reliable than a weak breakout.</li>
      <li> <b>Market Open/Close Behavior:</b> Pay attention to how price reacts to the previous session's POC and Value Area boundaries at the market open and near the close.</li>
      <li> <b>Fixed vs. Session Profile:</b> Understand when to use each. `volume.profile_session` is for recurring periods (e.g., daily) while `volume.profile_fixed` is for analyzing a specific range of bars, useful for studying reactions to news events or specific trend segments.</li>
    </ul>

    <div class="tip">
      <strong>Institutional Footprint:</strong> Volume Profile helps visualize where "smart money" (large institutions) has likely accumulated or distributed positions, as these are often the areas of highest volume.
    </div>

    <h2>Common Volume Profile Pitfalls</h2>
    <ul>
      <li> <b>Lagging Nature:</b> Volume Profile is a lagging indicator. It shows where volume *has been* traded, not where it *will* be traded. Use it for confirmation and understanding market structure, not as a standalone predictive tool.</li>
      <li> <b>False Signals:</b> Price can temporarily penetrate or "fake out" around key Volume Profile levels, especially in low-liquidity markets or during news events. Confirmation from price action and other indicators is essential.</li>
      <li> <b>Over-Reliance:</b> Using Volume Profile as the sole decision-making tool without considering the broader market context, fundamental news, or other technical analysis can lead to poor trading decisions.</li>
      <li> <b>Data Quality:</b> The accuracy of Volume Profile is highly dependent on the quality and granularity of volume data. Tick volume is more precise but not always available.</li>
      <li> <b>Visual Clutter:</b> With too many profiles or too many rows, the chart can become overly cluttered and difficult to read. Keep settings clean and focused.</li>
      <li> <b>Dynamic Nature in Strategies:</b> Implementing strategies based on *previous* session's POC/VAH/VAL can be tricky in Pine Script because `volume.profile_session` only provides the *current* session's data. You often need `request.security` to fetch previous session data, which can add complexity.</li>
    </ul>

    <h2>Conclusion</h2>
    <p>Volume Profile is an exceptionally powerful and insightful technical analysis tool available in Pine Script for TradingView. By providing a clear visualization of trading activity across different price levels, it allows traders to identify key areas of supply and demand, understand market conviction, and pinpoint significant support and resistance zones. Mastering its components – the Point of Control (POC), Value Area (VA), High Volume Nodes (HVN), and Low Volume Nodes (LVN) – can significantly enhance your <b>pine script strategies</b>. While requiring careful consideration of its settings and integration with other technical analysis, Volume Profile provides a unique "x-ray" view into market structure, helping you make more informed and robust trading decisions by understanding where the true battle between buyers and sellers took place.</p>
  </article>

  <ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9243803325136617"
     data-ad-slot="5548365171"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <script src="../scripts/scripts.js"></script>
  <script src="../scripts/dynamicContent.js" defer></script>
  <script src="../scripts/pinescript-disclaimer.js"></script>

</body>
</html>
