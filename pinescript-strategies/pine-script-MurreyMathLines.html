<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../styles/blog-common.css" />
    <style>
        .fullscreen {
            padding: 10px 50px;
            max-width: 70%;
            margin: auto;
            text-align: justify;
        }
        .tip {
            background: #e8f4fc;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 20px 0;
        }
        .code-comment {
            color: #6a9955;
            font-style: italic;
        }
    </style>
    <script id="mcjs">!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/1d0bc1a6c5f92dbb39d740b56/298aebd458318fd32c6cfc6a7.js");</script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-0MM8039GLD"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-0MM8039GLD');
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9243803325136617" crossorigin="anonymous"></script>

    <title>Pine Script Murrey Math Lines - Complete TradingView Guide</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="alternate" type="application/atom+xml" title="RSS Feed" href="/feed.xml" />

    <meta name="description" content="Master Murrey Math Lines in Pine Script for TradingView - a unique set of price levels derived from Gann's theories, used to identify potential support, resistance, and reversal points.">
    <meta name="keywords" content="pine script strategies, Murrey Math Lines, Murrey Math, Gann theory, tradingview indicator, technical analysis, support resistance, price action, reversal points, trend lines">

    <!-- Open Graph / Social Meta -->
    <meta property="og:title" content="Pine Script Murrey Math Lines - Complete TradingView Guide">
    <meta property="og:description" content="Comprehensive tutorial on implementing and using Murrey Math Lines in Pine Script for advanced trading strategies.">
    <meta property="og:type" content="article">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Pine Script Murrey Math Lines - Complete TradingView Guide">
    <link rel="canonical" href="https://offline-pixel.github.io/pinescript-strategies/pine-script-MurreyMathLines.html" />

    <!-- JSON-LD Schema -->
    <link rel="icon" href="../favicon.ico" type="image/x-icon">
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "Pine Script Murrey Math Lines - Complete TradingView Guide",
      "description": "Master Murrey Math Lines in Pine Script for TradingView - a unique set of price levels derived from Gann's theories, used to identify potential support, resistance, and reversal points.",
      "author": {
        "@type": "Person",
        "name": "Offline Pixel Computers"
      },
      "datePublished": "2025-06-10",
      "image": "https://offline-pixel.github.io/assets/logo2.png",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://offline-pixel.github.io/pinescript-strategies/pine-script-MurreyMathLines.html"
      },
      "publisher": {
        "@type": "Organization",
        "name": "Offline Pixel",
        "logo": {
          "@type": "ImageObject",
          "url": "https://offline-pixel.github.io/assets/logo2.png"
        }
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://offline-pixel.github.io/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "PineScript Strategies",
            "item": "https://offline-pixel.github.io/pinescript-strategies.html"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "Murrey Math Lines",
            "item": "https://offline-pixel.github.io/pinescript-strategies/pine-script-MurreyMathLines.html"
          }
        ]
      }
    }
    </script>
</head>
<body>
  <header class="blog-header">
    <div class="container">
      <h1 class="blog-title">Pine Script Murrey Math Lines </h1>
      <p class="blog-subtitle">Master this unique system of horizontal price levels in TradingView's Pine Script, based on W.D. Gann's theories, used to identify potential support, resistance, and crucial turning points in the market.</p>
      <p class="job-meta">
        <span class="job-posted-time">Last Updated on: <span id="dynamicDatePosted"></span></span>
        <span class="job-location">Expertise: Advanced</span>
      </p>
    </div>
  </header>

  <article class="fullscreen">
<nav class="breadcrumb" aria-label="Breadcrumb">
  <a href="https://offline-pixel.github.io/">Home</a> >
  <a href="https://offline-pixel.github.io/pinescript-strategies.html">PineScript Strategies</a> >
  <span aria-current="page">Murrey Math Lines</span>
</nav>

  <div class="pinescript-disclaimer"></div>
  <ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9243803325136617"
     data-ad-slot="5548365171"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    <h2>What are Murrey Math Lines?</h2>
    <p> <b>Murrey Math Lines</b> are a system of geometric price lines derived from the principles of W.D. Gann's squares. Developed by T. H. Murrey, this indicator simplifies Gann's complex theories into a practical set of equally spaced horizontal lines that divide price action into eight "octaves" or zones. These lines are intended to represent major and minor support and resistance levels where price is likely to find equilibrium, reverse, or accelerate.</p>

    <p>The core idea behind Murrey Math is that price tends to move in predictable ranges and will often react strongly at specific, harmonically related levels. Each of the nine lines (from 0/8 to 8/8) has a specific interpretation regarding price behavior:</p>
    <ul>
      <li> <b>0/8 (Extreme Oversold) & 8/8 (Extreme Overbought):</b> Strong support/resistance, indicating extreme conditions. Price rarely stays here long.</li>
      <li> <b>1/8 (Weak Support) & 7/8 (Weak Resistance):</b> Reversal zones. Price often reverses quickly from these levels.</li>
      <li> <b>2/8 (Strong Support) & 6/8 (Strong Resistance):</b> These are strong pivot points where price is likely to pause or reverse.</li>
      <li> <b>3/8 (Minor Support) & 5/8 (Minor Resistance):</b> Trading ranges often occur between these lines. Price may try to reverse from here, but less strongly than from 2/8 or 6/8.</li>
      <li> <b>4/8 (Major Reversal/Median Line):</b> The strongest support/resistance level. Price tends to gravitate towards this line, often reversing direction after crossing it.</li>
    </ul>

    <p>In Pine Script, implementing Murrey Math Lines involves defining a major price range (a "square") and then calculating these octave levels dynamically. They are a powerful tool for visual traders and can inform your <b><a href="https://offline-pixel.github.io/pinescript-strategies.html">pine script strategies</a></b> for entries, exits, and understanding market structure.</p>

    <h2>Components and Calculation</h2>
    <p>The calculation of Murrey Math Lines begins by identifying a significant trading range, often called the "Major Square." This range's highest high and lowest low within a defined period (e.g., 64, 128, or 256 bars) forms the basis. The range is then divided into eight equal parts.</p>
    <br>
    Let `HH` be the Highest High and `LL` be the Lowest Low over a specified `period`.

    <ol>
      <li> <b>Determine the Major Square Range:</b>
        * Find the `Max_Price = ta.highest(high, period)`
        * Find the `Min_Price = ta.lowest(low, period)`
        * `Price_Range = Max_Price - Min_Price`
      </li>
      <li> <b>Adjust Price Range to Nearest Power of 2 (for proper scaling):</b> Murrey's method involves scaling the price range to a power of 2 (e.g., 1, 2, 4, 8, 16, 32, 64, 128, etc.) to fit it within a "square." This normalization helps maintain consistency across different assets and price scales.
        * `Scaled_Range = (math.pow(2, math.ceil(math.log(Price_Range) / math.log(2))))`
        * `Min_Price_Adjusted = Min_Price - (Scaled_Range - Price_Range) / 2`
        * `Max_Price_Adjusted = Min_Price_Adjusted + Scaled_Range`
      </li>
      <li> <b>Calculate the Octave Step:</b>
        * `Octave_Step = Scaled_Range / 8`
      </li>
      <li> <b>Calculate Each Murrey Math Line:</b>
        * `0/8 Line = Min_Price_Adjusted`
        * `1/8 Line = Min_Price_Adjusted + Octave_Step`
        * `2/8 Line = Min_Price_Adjusted + (2 * Octave_Step)`
        * `3/8 Line = Min_Price_Adjusted + (3 * Octave_Step)`
        * `4/8 Line = Min_Price_Adjusted + (4 * Octave_Step)` (Median Line)
        * `5/8 Line = Min_Price_Adjusted + (5 * Octave_Step)`
        * `6/8 Line = Min_Price_Adjusted + (6 * Octave_Step)`
        * `7/8 Line = Min_Price_Adjusted + (7 * Octave_Step)`
        * `8/8 Line = Max_Price_Adjusted`
      </li>
    </ol>
    <p>These lines will remain constant for the period defined by the `lookbackPeriod` input until a new highest high or lowest low is established, forcing a recalculation of the "Major Square."</p>

    <h2>Basic Murrey Math Lines Implementation in Pine Script</h2>
    <p>Since Pine Script does not have a built-in `ta.murreyMathLines()` function, we will implement the calculation logic directly using standard Pine Script functions.</p>
<pre><code><span class="comment">//@version=5</span>
<span class="function">indicator</span>(<span class="string">"My Murrey Math Lines"</span>, overlay=<span class="keyword">true</span>, max_bars_back=<span class="number">500</span>) <span class="comment">// overlay=true to plot on price chart.</span>

<span class="comment">// --- User Inputs ---</span>
<span class="comment">// Period for identifying the major square (highest high and lowest low)</span>
<span class="keyword">lookbackPeriod</span> = <span class="function">input.int</span>(<span class="number">256</span>, <span class="keyword">title</span>=<span class="string">"Lookback Period (Bars for Major Square)"</span>, <span class="keyword">minval</span>=<span class="number">64</span>, <span class="keyword">maxval</span>=<span class="number">500</span>)
<span class="keyword">lineTransparency</span> = <span class="function">input.int</span>(<span class="number">0</span>, <span class="keyword">title</span>=<span class="string">"Line Transparency (0-100)"</span>, <span class="keyword">minval</span>=<span class="number">0</span>, <span class="keyword">maxval</span>=<span class="number">100</span>)
<span class="keyword">showLabels</span> = <span class="function">input.bool</span>(<span class="keyword">true</span>, <span class="keyword">title</span>=<span class="string">"Show Level Labels"</span>)

<span class="comment">// --- Calculate Murrey Math Levels ---</span>
<span class="comment">// 1. Find Highest High and Lowest Low over the lookback period</span>
highestHigh = <span class="function">ta.highest</span>(high, lookbackPeriod)
lowestLow = <span class="function">ta.lowest</span>(low, lookbackPeriod)

<span class="comment">// We only recalculate the base prices if a new significant high or low occurs.</span>
<span class="comment">// This makes the lines stable for periods and then shift.</span>
<span class="keyword">var</span> <span class="keyword">float</span> mmHighest = <span class="keyword">na</span>
<span class="keyword">var</span> <span class="keyword">float</span> mmLowest = <span class="keyword">na</span>
<span class="keyword">var</span> <span class="keyword">float</span> mmRange = <span class="keyword">na</span>

<span class="comment">// Recalculate MM base levels when a new highest high or lowest low is found within the lookback</span>
<span class="comment">// Use `ta.highestbars` and `ta.lowestbars` to find if the current high/low is the period's extreme</span>
<span class="keyword">if</span> (high[<span class="number">0</span>] == highestHigh <span class="keyword">and</span> bar_index == bar_index[<span class="function">ta.highestbars</span>(high, lookbackPeriod)]) <span class="keyword">or</span>
   (low[<span class="number">0</span>] == lowestLow <span class="keyword">and</span> bar_index == bar_index[<span class="function">ta.lowestbars</span>(low, lookbackPeriod)])

    <span class="comment">// 2. Adjust Price Range to Nearest Power of 2 (for proper scaling)</span>
    priceRange = highestHigh - lowestLow
    
    <span class="comment">// Handle cases where priceRange might be zero or too small</span>
    <span class="keyword">if</span> priceRange == <span class="number">0</span>
        priceRange := <span class="number">0.000000001</span> <span class="comment">// Small non-zero value to prevent issues</span>
    
    <span class="comment">// Calculate the power of 2 that covers the price range</span>
    pow2 = <span class="function">math.ceil</span>(<span class="function">math.log</span>(priceRange) / <span class="function">math.log</span>(<span class="number">2</span>))
    scaledRange = <span class="function">math.pow</span>(<span class="number">2</span>, pow2)

    <span class="comment">// Adjust the lowest price so that the range fits perfectly within the scaledRange</span>
    adjustedLowest = lowestLow - (scaledRange - priceRange) / <span class="number">2</span>
    
    <span class="comment">// Store these values to use for plotting all subsequent bars until a new extreme</span>
    mmHighest := adjustedLowest + scaledRange
    mmLowest := adjustedLowest
    mmRange := scaledRange

<span class="comment">// Use `nz()` to carry forward the last calculated levels</span>
mmHighest := <span class="function">nz</span>(mmHighest[<span class="number">1</span>], mmHighest)
mmLowest := <span class="function">nz</span>(mmLowest[<span class="number">1</span>], mmLowest)
mmRange := <span class="function">nz</span>(mmRange[<span class="number">1</span>], mmRange)

<span class="comment">// 3. Calculate the Octave Step</span>
octaveStep = mmRange / <span class="number">8.0</span>

<span class="comment">// 4. Calculate Each Murrey Math Line</span>
mm_8_8 = mmHighest
mm_7_8 = mmHighest - octaveStep
mm_6_8 = mmHighest - (<span class="number">2</span> * octaveStep)
mm_5_8 = mmHighest - (<span class="number">3</span> * octaveStep)
mm_4_8 = mmHighest - (<span class="number">4</span> * octaveStep) <span class="comment">// Median Line</span>
mm_3_8 = mmLowest + (<span class="number">3</span> * octaveStep)
mm_2_8 = mmLowest + (<span class="number">2</span> * octaveStep)
mm_1_8 = mmLowest + octaveStep
mm_0_8 = mmLowest

<span class="comment">// --- Plotting Murrey Math Levels ---</span>
<span class="comment">// Define colors and styles for each line for easier interpretation</span>
color_8_0 = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">red</span>, lineTransparency)
color_7_1 = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">orange</span>, lineTransparency)
color_6_2 = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">maroon</span>, lineTransparency) <span class="comment">// Stronger resistance/support</span>
color_5_3 = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">gray</span>, lineTransparency)
color_4_4 = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">purple</span>, lineTransparency) <span class="comment">// Median line, strongest</span>
color_line = <span class="keyword">color</span>.<span class="function">new</span>(<span class="keyword">color</span>.<span class="function">blue</span>, lineTransparency)

<span class="function">plot</span>(mm_0_8, <span class="keyword">title</span>=<span class="string">"0/8"</span>, <span class="keyword">color</span>=color_8_0, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)
<span class="function">plot</span>(mm_1_8, <span class="keyword">title</span>=<span class="string">"1/8"</span>, <span class="keyword">color</span>=color_7_1, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)
<span class="function">plot</span>(mm_2_8, <span class="keyword">title</span>=<span class="string">"2/8"</span>, <span class="keyword">color</span>=color_6_2, <span class="keyword">linewidth</span>=<span class="number">2</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>) <span class="comment">// Stronger</span>
<span class="function">plot</span>(mm_3_8, <span class="keyword">title</span>=<span class="string">"3/8"</span>, <span class="keyword">color</span>=color_5_3, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)
<span class="function">plot</span>(mm_4_8, <span class="keyword">title</span>=<span class="string">"4/8"</span>, <span class="keyword">color</span>=color_4_4, <span class="keyword">linewidth</span>=<span class="number">3</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>) <span class="comment">// Strongest</span>
<span class="function">plot</span>(mm_5_8, <span class="keyword">title</span>=<span class="string">"5/8"</span>, <span class="keyword">color</span>=color_5_3, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)
<span class="function">plot</span>(mm_6_8, <span class="keyword">title</span>=<span class="string">"6/8"</span>, <span class="keyword">color</span>=color_6_2, <span class="keyword">linewidth</span>=<span class="number">2</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>) <span class="comment">// Stronger</span>
<span class="function">plot</span>(mm_7_8, <span class="keyword">title</span>=<span class="string">"7/8"</span>, <span class="keyword">color</span>=color_7_1, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)
<span class="function">plot</span>(mm_8_8, <span class="keyword">title</span>=<span class="string">"8/8"</span>, <span class="keyword">color</span>=color_8_0, <span class="keyword">linewidth</span>=<span class="number">1</span>, <span class="keyword">style</span>=<span class="keyword">plot</span>.<span class="function">style_stepline</span>)

<span class="comment">// --- Optional: Add Labels to Lines ---</span>
<span class="keyword">if</span> showLabels <span class="keyword">and</span> bar_index == last_bar_index
    <span class="comment">// Only draw labels on the current (last) bar for clarity</span>
    <span class="function">label.new</span>(x=bar_index, y=mm_0_8, <span class="keyword">text</span>=<span class="string">"0/8 - Extreme Oversold"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_8_0, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_1_8, <span class="keyword">text</span>=<span class="string">"1/8 - Weak Support"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_7_1, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_2_8, <span class="keyword">text</span>=<span class="string">"2/8 - Strong Support"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_6_2, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_3_8, <span class="keyword">text</span>=<span class="string">"3/8 - Minor Support"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_5_3, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_4_8, <span class="keyword">text</span>=<span class="string">"4/8 - Median Line (Major S/R)"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_4_4, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_5_8, <span class="keyword">text</span>=<span class="string">"5/8 - Minor Resistance"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_5_3, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_6_8, <span class="keyword">text</span>=<span class="string">"6/8 - Strong Resistance"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_6_2, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_7_8, <span class="keyword">text</span>=<span class="string">"7/8 - Weak Resistance"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_7_1, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)
    <span class="function">label.new</span>(x=bar_index, y=mm_8_8, <span class="keyword">text</span>=<span class="string">"8/8 - Extreme Overbought"</span>, <span class="keyword">style</span>=<span class="keyword">label</span>.<span class="function">style_label_left</span>, <span class="keyword">color</span>=color_8_0, <span class="keyword">textcolor</span>=<span class="keyword">color</span>.<span class="function">white</span>, <span class="keyword">size</span>=<span class="keyword">size</span>.<span class="function">small</span>)


<span class="comment">// --- Simple Strategy Example (Conceptual) ---</span>
<span class="comment">// This strategy demonstrates how you might react to Murrey Math levels.</span>
<span class="comment">// It is highly simplified and for educational purposes only.</span>
<span class="comment">// Real trading strategies require more complex confirmation.</span>

<span class="function">strategy</span>(<span class="string">"Murrey Math Strategy"</span>, overlay=<span class="keyword">true</span>)

<span class="comment">// Use the calculated Murrey Math levels for strategy logic</span>
<span class="comment">// Re-calculate the levels to ensure they are available to the strategy</span>
<span class="comment">// (This is redundant if the above indicator part is run first, but good practice for standalone strategy)</span>
<span class="keyword">var</span> <span class="keyword">float</span> strat_mmHighest = <span class="keyword">na</span>
<span class="keyword">var</span> <span class="keyword">float</span> strat_mmLowest = <span class="keyword">na</span>
<span class="keyword">var</span> <span class="keyword">float</span> strat_mmRange = <span class="keyword">na</span>

highestHigh_strat = <span class="function">ta.highest</span>(high, lookbackPeriod)
lowestLow_strat = <span class="function">ta.lowest</span>(low, lookbackPeriod)

<span class="keyword">if</span> (high[<span class="number">0</span>] == highestHigh_strat <span class="keyword">and</span> bar_index == bar_index[<span class="function">ta.highestbars</span>(high, lookbackPeriod)]) <span class="keyword">or</span>
   (low[<span class="number">0</span>] == lowestLow_strat <span class="keyword">and</span> bar_index == bar_index[<span class="function">ta.lowestbars</span>(low, lookbackPeriod)])

    priceRange_strat = highestHigh_strat - lowestLow_strat
    <span class="keyword">if</span> priceRange_strat == <span class="number">0</span>
        priceRange_strat := <span class="number">0.000000001</span>
    
    pow2_strat = <span class="function">math.ceil</span>(<span class="function">math.log</span>(priceRange_strat) / <span class="function">math.log</span>(<span class="number">2</span>))
    scaledRange_strat = <span class="function">math.pow</span>(<span class="number">2</span>, pow2_strat)
    adjustedLowest_strat = lowestLow_strat - (scaledRange_strat - priceRange_strat) / <span class="number">2</span>
    
    strat_mmHighest := adjustedLowest_strat + scaledRange_strat
    strat_mmLowest := adjustedLowest_strat
    strat_mmRange := scaledRange_strat

strat_mmHighest := <span class="function">nz</span>(strat_mmHighest[<span class="number">1</span>], strat_mmHighest)
strat_mmLowest := <span class="function">nz</span>(strat_mmLowest[<span class="number">1</span>], strat_mmLowest)
strat_mmRange := <span class="function">nz</span>(strat_mmRange[<span class="number">1</span>], strat_mmRange)
strat_octaveStep = strat_mmRange / <span class="number">8.0</span>

strat_mm_0_8 = strat_mmLowest
strat_mm_1_8 = strat_mmLowest + strat_octaveStep
strat_mm_2_8 = strat_mmLowest + (<span class="number">2</span> * strat_octaveStep)
strat_mm_3_8 = strat_mmLowest + (<span class="number">3</span> * strat_octaveStep)
strat_mm_4_8 = strat_mmLowest + (<span class="number">4</span> * strat_octaveStep)
strat_mm_5_8 = strat_mmLowest + (<span class="number">5</span> * strat_octaveStep)
strat_mm_6_8 = strat_mmLowest + (<span class="number">6</span> * strat_octaveStep)
strat_mm_7_8 = strat_mmLowest + (<span class="number">7</span> * strat_octaveStep)
strat_mm_8_8 = strat_mmHighest


<span class="comment">// Strategy Logic: Reversals at 0/8, 8/8, and 4/8 lines (Median Line)</span>

<span class="comment">// Buy at 0/8 or 1/8 (extreme oversold/weak support)</span>
longCondition = <span class="function">ta.crossover</span>(close, strat_mm_0_8) <span class="keyword">or</span> <span class="function">ta.crossover</span>(close, strat_mm_1_8)

<span class="comment">// Sell at 8/8 or 7/8 (extreme overbought/weak resistance)</span>
shortCondition = <span class="function">ta.crossunder</span>(close, strat_mm_8_8) <span class="keyword">or</span> <span class="function">ta.crossunder</span>(close, strat_mm_7_8)

<span class="comment">// Additional reversal at 4/8 (Median Line) - can be entry or exit</span>
<span class="comment">// If price crosses 4/8 from below, it's bullish. If from above, it's bearish.</span>
long4_8 = <span class="function">ta.crossover</span>(close, strat_mm_4_8)
short4_8 = <span class="function">ta.crossunder</span>(close, strat_mm_4_8)

<span class="keyword">if</span> (longCondition)
    <span class="function">strategy.entry</span>(<span class="string">"Long MM"</span>, <span class="keyword">strategy</span>.<span class="function">long</span>)

<span class="keyword">if</span> (shortCondition)
    <span class="function">strategy.entry</span>(<span class="string">"Short MM"</span>, <span class="keyword">strategy</span>.<span class="function">short</span>)

<span class="comment">// Exit logic: Using 4/8 line as profit target or reversal point</span>
<span class="comment">// Or using fixed stop loss and profit target based on levels</span>
<span class="keyword">profitTargetLong</span> = strat_mm_4_8 <span class="comment">// Target 4/8 for long</span>
<span class="keyword">stopLossLong</span> = strat_mm_0_8 - (strat_octaveStep / <span class="number">2</span>) <span class="comment">// Below 0/8, giving some buffer</span>

<span class="keyword">profitTargetShort</span> = strat_mm_4_8 <span class="comment">// Target 4/8 for short</span>
<span class="keyword">stopLossShort</span> = strat_mm_8_8 + (strat_octaveStep / <span class="number">2</span>) <span class="comment">// Above 8/8, giving some buffer</span>

<span class="function">strategy.exit</span>(<span class="string">"Long MM Exit"</span>, <span class="keyword">from_entry</span>=<span class="string">"Long MM"</span>, <span class="keyword">profit</span>=profitTargetLong, <span class="keyword">stop</span>=stopLossLong)
<span class="function">strategy.exit</span>(<span class="string">"Short MM Exit"</span>, <span class="keyword">from_entry</span>=<span class="string">"Short MM"</span>, <span class="keyword">profit</span>=profitTargetShort, <span class="keyword">stop</span>=stopLossShort)
</code></pre>


    <h2>Optimizing Murrey Math Lines Performance</h2>
    <p>To get the most from Murrey Math Lines in Pine Script:</p>
    <ul>
      <li><strong>Lookback Period Tuning:</strong> The `lookbackPeriod` is critical. A longer period (e.g., 256 bars) creates broader, more stable levels, suitable for higher timeframes and long-term analysis. Shorter periods (e.g., 64 bars) create more dynamic levels suitable for short-term trading. Experiment to find the optimal period for your asset and timeframe.</li>
      <li><strong>Confluence is Key:</strong> Murrey Math Lines are most effective when they align with other forms of support/resistance, such as:
        <ul>
          <li>Trendlines</li>
          <li>Moving Averages</li>
          <li>Previous significant highs/lows</li>
          <li>Fibonacci Retracements</li>
        </ul>
        A bounce off a Murrey Math line that also aligns with a strong trendline is a higher probability signal.</li>
      <li><strong>Price Action Confirmation:</strong> Always confirm price reactions at Murrey Math levels with strong candlestick patterns (e.g., bullish engulfing, hammer at support; bearish engulfing, shooting star at resistance) and volume.</li>
      <li><strong>Understanding Line Behavior:</strong> Learn the specific characteristics of each octave (e.g., price bouncing quickly from 1/8 and 7/8, strong reactions at 2/8 and 6/8, the magnet effect of 4/8).</li>
      <li><strong>Trade Management:</strong> Use the lines for entry, target, and stop-loss placement. For example, enter a long trade at 2/8 with a target at 4/8 and a stop-loss just below 1/8.</li>
      <li><strong>Adapting to Volatility:</strong> In highly volatile markets, the "Octave Step" will be larger, creating wider zones. In low-volatility markets, they will be tighter. Adjust your expectations accordingly.</li>
    </ul>

    <div class="tip">
      <strong>Geometric Harmony:</strong> Murrey Math Lines divide price into harmonically related octaves, based on Gann's theory that markets move in predictable, geometric patterns. This offers a unique perspective on price behavior.
    </div>

    <h2>Common Murrey Math Lines Pitfalls</h2>
    <ul>
      <li> <b>Subjectivity of "Major Square":</b> While the calculation is fixed, defining the `lookbackPeriod` for the initial highest high and lowest low can be subjective. An improperly chosen period can lead to irrelevant lines.</li>
      <li> <b>Not Always Exact:</b> While often precise, price will not always bounce exactly off a Murrey Math line. They should be treated as zones or areas of interest.</li>
      <li> <b>Complex Calculation:</b> The underlying mathematical adjustments (to a power of 2) can be challenging to understand for beginners, making it feel less intuitive than simple moving averages.</li>
      <li> <b>Whipsaws in Choppy Markets:</b> In highly consolidating or whipsaw markets, price might oscillate frequently between levels, generating false signals if not combined with other filters.</li>
      <li> <b>Over-Reliance:</b> Like all indicators, Murrey Math Lines are best used as part of a comprehensive trading plan, not as a standalone signal generator.</li>
      <li> <b>Lagging Element:</b> While the lines themselves are fixed for a period, the initial determination of the "Major Square" is based on past price action, introducing a slight lagging element for the overall framework.</li>
    </ul>

    <h2>Conclusion</h2>
    <p>Murrey Math Lines offer a fascinating and structured approach to technical analysis in Pine Script for TradingView. Derived from W.D. Gann's theories, these equally spaced horizontal lines provide a unique framework for identifying potential support, resistance, and crucial turning points within various "octaves" of price action. While their calculation requires a clear definition of the "Major Square" and their interpretation benefits from an understanding of each line's significance, mastering Murrey Math can significantly enhance your <b><a href="https://offline-pixel.github.io/pinescript-strategies.html">pine script strategies</a></b>. By combining these powerful levels with price action confirmation, volume analysis, and other technical tools, you can leverage Murrey Math Lines to improve your decision-making, anticipate market reactions, and gain a deeper understanding of market harmony and equilibrium.</p>
  
        <section class="cta-section custom-strategy-cta">
            <h2 class="cta-title">Enhance Your Trading</h2>
            <p>Get a high-performance Pine Script analysis tool for actionable market insights, designed for traders on the move.</p>
            <p>This strategy runs in live mode on TradingView, helping you identify potential opportunities.</p>
            <a href="https://offlinepixel.gumroad.com/l/trader-on-the-go" class="btn custom-btn" target="_blank" rel="noopener noreferrer">
              Subscribe now @ $99/month
            </a>
        </section>
</article>

  <ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9243803325136617"
     data-ad-slot="5548365171"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <script src="../scripts/scripts.js"></script>
  <script src="../scripts/dynamicContent.js" defer></script>
  <script src="../scripts/pinescript-disclaimer.js"></script>

</body>
</html>
